-- Active: 1663797586807@@127.0.0.1@3306@ma_nouvelle_base
CREATE DATABASE UNIVERSITY;
USE UNIVERSITY;

CREATE TABLE DEPT (
DEPTNO          INT NOT NULL,
DNAME           VARCHAR(14),
LOC             VARCHAR(13),
CONSTRAINT pk_DEPT PRIMARY KEY(DEPTNO) 
);

CREATE TABLE EMP (
EMPNO            INT NOT NULL,
ENAME            VARCHAR(25),
JOB              VARCHAR(25),
MGR              INT,
EMBAUCHE         DATE,
SAL              INT,
COMM             INT,
DEPTNO           INT NOT NULL,
CONSTRAINT pk_EMP PRIMARY KEY (EMPNO) ,
CONSTRAINT fk_emp FOREIGN KEY(DEPTNO) REFERENCES DEPT(DEPTNO) 
);

# FILL THE TABLE DEPARTMENT
INSERT INTO DEPT VALUES (20, 'RECHERCHE', 'DALLAS');
INSERT INTO DEPT VALUES (10, 'DIRECTION','NEW YORK');
INSERT INTO DEPT VALUES (30, 'VENTE', 'CHICAGO');
INSERT INTO DEPT VALUES (40,'PRODUCTION','BOSTON');

# FILL THE TABLE EMPLOYEE
INSERT INTO EMP VALUES (7839,'KING','PRESIDENT',NULL,'1982-11-13',5000,NULL,10);
INSERT INTO EMP VALUES (7698,'BLAKE','MANAGER',7839,'1981-11-18',2850,NULL,30);
INSERT INTO EMP VALUES (7782,'CLARK','MANAGER',7839,'1983-12-13',2450,NULL,10);
INSERT INTO EMP VALUES (7566,'JONES','MANAGER',7839,'1982-03-18',2975,NULL,20);
INSERT INTO EMP VALUES (7654,'MARTIN','Ingenieur',7698,'1984-05-18',1250,1400,30);
INSERT INTO EMP VALUES (7499,'ALLEN','INGENIEUR',7698,'1982-08-18',1600,300,30);
INSERT INTO EMP VALUES (7844,'TURNER','INGENIEUR',7698,'1982-05-18',1500,0,30);
INSERT INTO EMP VALUES (7900,'JAMES','COMMERCIAL',7698,'1981-04-17',950,NULL,30);
INSERT INTO EMP VALUES (7521,'WARD','INGENIEUR',7698,'1985-04-17',1250,500,30);
INSERT INTO EMP VALUES (7902,'FORD','ANALYST',7566,'1988-05-18',3000,NULL,20);
INSERT INTO EMP VALUES (7369,'SMITH','COMMERCIAL',7902,'1985-08-18',800,NULL,20);
INSERT INTO EMP VALUES (7788,'SCOTT','ANALYST',7566,'1981-08-18',3000,NULL,20);
INSERT INTO EMP VALUES (7876,'ADAMS','COMMERCIAL',7788,'1982-08-06',1100,NULL,20);
INSERT INTO EMP VALUES (7934,'MILLER','COMMERCIAL',7782,'1981-08-01',1300,NULL,10);

# MANIPULATIONS
DESCRIBE DEPT;
DESCRIBE EMP;
SELECT * FROM DEPT;
SELECT * FROM EMP;
SELECT DEPTNO, LOC FROM DEPT WHERE DNAME = 'VENTE';

--------------------------- TP1 -------------------------------
-- 1
SELECT ENAME FROM EMP WHERE EMPNO = 7782;

-- 2 
SELECT ENAME, SAL, 1.1*SAL AS 'SALAIRE AUGMENTEE DE 10%' FROM EMP;

-- 3
SELECT AVG(SAL) FROM EMP;

-- ESSAIE JOINTURE
-- SELECT DNAME FROM DEPT INNER JOIN EMP ON DEPT.DEPTNO = EMP.DEPTNO;

-- 4
SELECT ENAME, EMBAUCHE, SAL, DEPT.DNAME FROM EMP JOIN DEPT ON EMP.DEPTNO = DEPT.DEPTNO;

-- 5
SELECT SAL, ENAME, D.DNAME, E.SAL FROM EMP E JOIN DEPT D ON E.DEPTNO = D.DEPTNO ORDER BY D.DNAME AND E.SAL;

-- 6 
SELECT ENAME FROM EMP WHERE SAL > 3000;

-- 7
SELECT ENAME FROM EMP WHERE SAL BETWEEN 2000 AND 6000;

-- 8
SELECT ENAME FROM EMP WHERE COMM IS NOT NULL;

-- 9
SELECT ENAME FROM EMP WHERE COMM IS NULL;

 -- 10
 SELECT ENAME, EMBAUCHE FROM EMP WHERE ENAME LIKE '_l%';
 
 -- 11
 SELECT * FROM EMP E INNER JOIN DEPT D ON E.DEPTNO = D.DEPTNO WHERE DNAME = 'VENTE' AND E.SAL > 3000;
 
 -- 12 
 SELECT * FROM EMP E INNER JOIN DEPT D ON E.DEPTNO = D.DEPTNO WHERE DNAME != 'RECHERCHE';





----------------------------- REQUETTES NON TESTER -----------------------------

-- 13 
SELECT * FROM EMP E JOIN DEPT D ON E.DEPTNO  = D.DEPTNO WHERE D.DEPTNO IN (20, 10, 30);

-- 14
SELECT SUM(SAL) FROM EMP WHERE DEPTNO = 30;
    
-- 15
SELECT MAX(SAL) FROM EMP;

-- 16
SELECT * FROM EMP WHERE SAL = ( SELECT MAX(SAL) FROM EMP);

-- 17
SELECT JOB, COUNT(*), AVG(SAL) FROM EMP GROUP BY JOB HAVING COUNT(*) >= 2;

-- 18
SELECT ENAME FROM EMP GROUP BY DEPTNO, JOB;

-- 19
SELECT COUNT(*) FROM EMP GROUP BY DEPTNO;

-- 20
SELECT DEPTNO, COUNT(*) FROM EMP GROUP BY DEPTNO;

-- 21
SELECT DEPTNO, COUNT(*) FROM EMP WHERE JOB = 'MANAGER' GROUP BY DEPTNO;

-- 22
SELECT EMBAUCHE FROM EMP WHERE EMBAUCHE = (SELECT MAX(EMBAUCHE) FROM EMP);

