
SHOW DATABASES;
-- SQLBook: Code
CREATE DATABASE MA_BASE_TP3;
-- SQLBook: Code
USE MA_BASE_TP3;

DROP TABLE DEPT;
CREATE TABLE DEPT(
    NUMDEPT INT ,
    NOMD VARCHAR(30) ,
    LIEU VARCHAR(30),
    CONSTRAINT PK_DEPT PRIMARY KEY(NUMDEPT)
);
-- SQLBook: Code
-- Active: 1663797586807@@127.0.0.1@3306@ma_base_tp3CREATE TABLE EMP(
CREATE TABLE EMP(
    NUMEMP INT ,
    NOM VARCHAR(30),
    FONCTION VARCHAR(30),
    NUMSUP INT, 
    DATEEMBAUCHE DATE, 
    SAL INT ,
    COMM INT ,
    NUMDEPT INT ,
    CONSTRAINT PK_EMP PRIMARY KEY(NUMEMP),
    CONSTRAINT FK_EMP FOREIGN KEY(NUMDEPT) REFERENCES DEPT(NUMDEPT)
);

describe DEPT;
-- DROP TABLE PROJET;
CREATE TABLE PROJET(
    NUMPROJ INT ,
    NOMP VARCHAR(30) ,
    NUMDEPT INT,
    CONSTRAINT PK_PROJET PRIMARY KEY(NUMPROJ),
    CONSTRAINT FK_PROJET FOREIGN KEY(NUMDEPT) REFERENCES DEPT(NUMDEPT)
);

-- DROP TABLE TRAVAILLE;
CREATE TABLE TRAVAILLE(
    NUMEMP INT,
    NUMPROJ INT,
    NBHEURES INT,
    CONSTRAINT PK_PROJET PRIMARY KEY(NUMEMP,NUMPROJ),
    CONSTRAINT FK1_PROJET FOREIGN KEY(NUMEMP) REFERENCES EMP(NUMEMP),
    CONSTRAINT FK2_PROJET FOREIGN KEY(NUMPROJ) REFERENCES PROJET(NUMPROJ)
    
);
-- DELETE FROM EMP WHERE NUMEMP = '7839';
INSERT INTO EMP VALUES 
(7839,'KING','PRESIDENT',NULL,'1981-11-17',5000,NULL,10),
(7566,'JONES','MANAGER',7839,'1981-04-02',2975,NULL,20),
 (7698,'BLAKE','MANAGER',7839,'2000-05-01',2850,NULL,30),
 (7782,'CLARK','MANAGER',7839,'1981-06-09',2450,NULL,10),
 (7369,'SMITH','COMMERCIAL',7566,'2002-12-17',800,20,20),
 (7499,'ALLEN','INGENIEUR',7698,'1981-02-20',1600,300,30),
 (7521,'WARD','INGENIEUR',7698,'1999-02-22',1250,500,30),
 (7654,'MARTIN','INGENIEUR',7698,'1010-09-28',1250,1400,30),
 (7844,'TURNER','INGENIEUR',7698,'1981-09-08',1500,0,30),
 (7900,'JAMES','COMMERCIAL',7698,'1981-12-03',950,NULL,30),
 (7788,'SCOTT','ANALYST',7566,'1987-04-19',3000,NULL,20),
 (7876,'ADAMS','COMMERCIAL',7788,'1987-05-23',1100,NULL,20),
 (7902,'FORD','ANALYST',7566,'1981-12-03',3000,NULL,20),
 (7934,'MILLER','COMMERCIAL',7782,'1982-01-23',1300,NULL,10),
 (7935,'ATIKIN','ANALYST',7782,'1990-01-23',1200,NULL,10);
 
INSERT INTO DEPT VALUES 
(10,'DIRECTION','GENEVE'),
 (20,'RECHERCHE','DALLAS'),
 (30,'VENTE','CHICAGO'),
 (40,'FABRICATION','BOSTON');
 
INSERT INTO PROJET VALUES  
 (1,'ALIO',10),
 (2,'SIP1',20),
 (3,'VENIP',30),
 (4,'ABLAY',30),
 (5,'ASIP',10),
 (6,'SIP2',20);
 
 SELECT * FROM TRAVAILLE;
 INSERT INTO TRAVAILLE VALUES 
 (7499,1,100),
 (7499,2,70),
 (7521,1,30),
 (7566,1,45),
 (7654,1,25),
 (7654,2,30),
 (7654,3,70),
 (7654,4,45),
 (7654,6,100),
 (7902,6,35),
 (7902,2,75),
 (7935,1,67),
 (7935,2,75),
 (7844,3,66),
 (7844,5,33);
 
 DESCRIBE EMP;
 
 SELECT * FROM EMP;
SELECT * FROM EMP 
WHERE FONCTION = 'COMMERCIAL';

-- 1
UPDATE EMP SET SAL = SAL*1.05 
WHERE FONCTION = 'COMMERCIAL';

-- 2
UPDATE EMP SET SAL = SAL*1.1,
 COMM = COMM + 500
 WHERE NUMEMP = '7369';
 
-- 3
UPDATE EMP SET NOM = 'ALI' WHERE NUMEMP = 7521;

-- 4
DELETE FROM EMP
WHERE NUMEMP = '7934';

-- 5
UPDATE EMP SET COMM = COMM + 300 
WHERE NOM LIKE 'M%';

-- 6
UPDATE EMP SET COMM = 350 
WHERE COMM IS NULL;

-- 7
UPDATE EMP E JOIN TRAILLE T ON E.NUMEMP = T.NUMEMP
JOIN PROJET P ON T.NUMPROJ = P.NUMPROJ 
SET NBHEURES = NBHEURES + 20 
WHERE E.NOM = 'AKTIN';

-- 8
INSERT INTO DEPT VALUES
(50, 'COMPTABILITE','TOULOUSE');

-- 9
INSERT INTO DEPT VALUES
(60, 'DIRECTION', NULL);

-- 10 a revoir
INSERT INTO DEPT SELECT DEFAULT, NUMDEPT = 25 FROM DEPT WHERE NUMDEPT = 20;

-- 11
UPDATE EMP SET FONCTION = 'PDG', NUMDEPT = 60 
WHERE NOM = 'MERCIER';

-- 12
DELETE FROM EMP WHERE NOM = 'BIROUT';

-- 13 
UPDATE EMP E SET SAL = 0.9*SAL
WHERE NUMDEPT = 10;

-- 14
INSERT INTO EMP VALUES
(7910,'SIMON', NULL, NULL, NULL,10000,NULL,30);
UPDATE DEPT D JOIN EMP E ON E.NUMDEPT = D.NUMDEPT SET D.NUMDEPT = 30 WHERE E.NOM = 'SIMON';

-- 15
DELETE EMP, DEPT FROM EMP E JOIN DEPT D ON E.NUMDEPT = D.NUMDEPT WHERE LIEU = 'CHICAGO';

-- 16
CREATE TABLE DEPT_ARCHIV(
    NUMDEPT INT ,
    NOMD VARCHAR(30) ,
    LIEU VARCHAR(30),
    CONSTRAINT PK_DEPT PRIMARY KEY(NUMDEPT)
);
INSERT INTO DEPT_ARCHIV SELECT * FROM DEPT;
